2025-01-20 05:20:47.999 +00:00 [INF] Starting database migration. Connection String: Host=admindb;Port=5432;Database=OnAimAdmin;Username=postgres;Password=Test1234!;Pooling=true;
2025-01-20 05:20:51.166 +00:00 [ERR] An error occurred while applying migrations.
System.Net.Sockets.SocketException (00000005, 0xFFFDFFFF): Name or service not known
   at System.Net.Dns.GetHostEntryOrAddressesCore(String hostName, Boolean justAddresses, AddressFamily addressFamily, Nullable`1 startingTimestamp)
   at System.Net.Dns.GetHostAddresses(String hostNameOrAddress, AddressFamily family)
   at Npgsql.Internal.NpgsqlConnector.Connect(NpgsqlTimeout timeout)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists()
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.Exists()
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrations()
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
2025-01-20 05:20:51.366 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-01-20 05:20:51.367 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-01-20 05:20:51.373 +00:00 [INF] Creating key {4df01c6c-9fc0-4f75-9684-9204925e36bf} with creation date 2025-01-20 05:20:51Z, activation date 2025-01-20 05:20:51Z, and expiration date 2025-04-20 05:20:51Z.
2025-01-20 05:20:51.380 +00:00 [WRN] No XML encryptor configured. Key {4df01c6c-9fc0-4f75-9684-9204925e36bf} may be persisted to storage in unencrypted form.
2025-01-20 05:20:51.521 +00:00 [INF] Now listening on: http://[::]:8080
2025-01-20 05:20:51.521 +00:00 [INF] Now listening on: https://[::]:8081
2025-01-20 05:20:51.521 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 05:20:51.522 +00:00 [INF] Hosting environment: Development
2025-01-20 05:20:51.522 +00:00 [INF] Content root path: /app
2025-01-20 09:20:22.888 +04:00 [INF] Starting database migration. Connection String: Host=admindb;Port=5432;Database=OnAimAdmin;Username=postgres;Password=Test1234!;Pooling=true;
2025-01-20 09:20:25.272 +04:00 [ERR] An error occurred while applying migrations.
System.Net.Sockets.SocketException (0x00002AF9): No such host is known.
   at System.Net.Dns.GetHostEntryOrAddressesCore(String hostName, Boolean justAddresses, AddressFamily addressFamily, Nullable`1 startingTimestamp)
   at System.Net.Dns.GetHostAddresses(String hostNameOrAddress, AddressFamily family)
   at Npgsql.Internal.NpgsqlConnector.Connect(NpgsqlTimeout timeout)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists()
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.Exists()
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrations()
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
2025-01-20 09:20:25.401 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 09:20:25.532 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 09:20:25.566 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 09:20:25.568 +04:00 [INF] Hosting environment: Development
2025-01-20 09:20:25.572 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 09:20:25.814 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 09:20:25.936 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 34.1650 ms
2025-01-20 09:20:25.938 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 09:20:25.938 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 09:20:25.941 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 129.6626ms
2025-01-20 09:20:25.943 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 5.2731ms
2025-01-20 09:20:26.121 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 182.1957ms
2025-01-20 09:20:26.145 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 09:20:26.629 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 482.1696 ms
2025-01-20 09:20:26.630 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 485.1873ms
2025-01-20 09:20:31.153 +04:00 [INF] Request starting HTTP/1.1 HEAD http://localhost:5192/ - null null
2025-01-20 09:20:31.157 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 09:20:31.391 +04:00 [INF] HTTP HEAD / responded 404 in 236.0508 ms
2025-01-20 09:20:31.392 +04:00 [INF] Request finished HTTP/1.1 HEAD http://localhost:5192/ - 404 null null 239.3325ms
2025-01-20 09:20:31.394 +04:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: HEAD http://localhost:5192/, Response status code: 404
2025-01-20 09:20:54.810 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 509
2025-01-20 09:20:54.818 +04:00 [INF] CORS policy execution successful.
2025-01-20 09:20:54.967 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 09:20:57.328 +04:00 [ERR] An error occurred using the connection to database 'OnAimAdmin' on server 'tcp://admindb:5432'.
2025-01-20 09:20:57.341 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.Admin.DatabaseContext'.
System.Net.Sockets.SocketException (11001): No such host is known.
   at System.Net.NameResolutionPal.ProcessResult(SocketError errorCode, GetAddrInfoExContext* context)
   at System.Net.NameResolutionPal.GetAddressInfoExCallback(Int32 error, Int32 bytes, NativeOverlapped* overlapped)
--- End of stack trace from previous location ---
   at System.Net.Dns.<GetAddrInfoWithTelemetryAsync>g__CompleteAsync|34_0[T](Task task, String hostName, Int64 startingTimestamp)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync[TResult](Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.Net.Sockets.SocketException (11001): No such host is known.
   at System.Net.NameResolutionPal.ProcessResult(SocketError errorCode, GetAddrInfoExContext* context)
   at System.Net.NameResolutionPal.GetAddressInfoExCallback(Int32 error, Int32 bytes, NativeOverlapped* overlapped)
--- End of stack trace from previous location ---
   at System.Net.Dns.<GetAddrInfoWithTelemetryAsync>g__CompleteAsync|34_0[T](Task task, String hostName, Int64 startingTimestamp)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync[TResult](Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 09:20:57.469 +04:00 [ERR] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 500 in 2652.1006 ms
System.Net.Sockets.SocketException (11001): No such host is known.
   at System.Net.NameResolutionPal.ProcessResult(SocketError errorCode, GetAddrInfoExContext* context)
   at System.Net.NameResolutionPal.GetAddressInfoExCallback(Int32 error, Int32 bytes, NativeOverlapped* overlapped)
--- End of stack trace from previous location ---
   at System.Net.Dns.<GetAddrInfoWithTelemetryAsync>g__CompleteAsync|34_0[T](Task task, String hostName, Int64 startingTimestamp)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync[TResult](Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at OnAim.Admin.Infrasturcture.Repository.RoleRepository.GetAllRoles() in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.Infrasturcture\Repositories\RoleRepository.cs:line 37
   at OnAim.Admin.APP.Services.Admin.AuthServices.PermissionService.GetEndpointsByRolesAsync() in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.APP\Services\AdminServices\AuthServices\PermissionService.cs:line 19
   at OnAim.Admin.APP.Services.Admin.AuthServices.PermissionService.RolesContainPermission(List`1 roles, String permission) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.APP\Services\AdminServices\AuthServices\PermissionService.cs:line 44
   at OnAim.Admin.API.Middleware.PermissionMiddleware.Invoke(HttpContext context, IPermissionService permissionService, ILogRepository auditLogService, ISecurityContextAccessor securityContextAccessor) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Middlewares\PermissionMiddleware.cs:line 65
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-01-20 09:20:57.478 +04:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.Sockets.SocketException (11001): No such host is known.
   at System.Net.NameResolutionPal.ProcessResult(SocketError errorCode, GetAddrInfoExContext* context)
   at System.Net.NameResolutionPal.GetAddressInfoExCallback(Int32 error, Int32 bytes, NativeOverlapped* overlapped)
--- End of stack trace from previous location ---
   at System.Net.Dns.<GetAddrInfoWithTelemetryAsync>g__CompleteAsync|34_0[T](Task task, String hostName, Int64 startingTimestamp)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync[TResult](Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at OnAim.Admin.Infrasturcture.Repository.RoleRepository.GetAllRoles() in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.Infrasturcture\Repositories\RoleRepository.cs:line 37
   at OnAim.Admin.APP.Services.Admin.AuthServices.PermissionService.GetEndpointsByRolesAsync() in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.APP\Services\AdminServices\AuthServices\PermissionService.cs:line 19
   at OnAim.Admin.APP.Services.Admin.AuthServices.PermissionService.RolesContainPermission(List`1 roles, String permission) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.APP\Services\AdminServices\AuthServices\PermissionService.cs:line 44
   at OnAim.Admin.API.Middleware.PermissionMiddleware.Invoke(HttpContext context, IPermissionService permissionService, ILogRepository auditLogService, ISecurityContextAccessor securityContextAccessor) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Middlewares\PermissionMiddleware.cs:line 65
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-01-20 09:20:57.490 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 500 null text/plain; charset=utf-8 2679.3964ms
2025-01-20 09:21:42.274 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 09:21:42.421 +04:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:21:42.432 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:21:42.466 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:21:42.488 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:21:42.489 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:21:42.496 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 09:21:42.543 +04:00 [ERR] Failed executing DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 09:21:42.557 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 09:21:42.661 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 09:21:42.736 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 09:21:42.763 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 09:21:42.765 +04:00 [INF] Hosting environment: Development
2025-01-20 09:21:42.766 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 09:21:43.693 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 09:21:43.795 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 34.4233 ms
2025-01-20 09:21:43.796 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 09:21:43.797 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 09:21:43.798 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 107.3279ms
2025-01-20 09:21:43.800 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 4.5033ms
2025-01-20 09:21:43.817 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 19.5184ms
2025-01-20 09:21:43.880 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 09:21:44.236 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 353.6757 ms
2025-01-20 09:21:44.238 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 357.5542ms
2025-01-20 09:21:51.212 +04:00 [INF] Request starting HTTP/1.1 HEAD http://localhost:5192/ - null null
2025-01-20 09:21:51.214 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 09:21:51.336 +04:00 [INF] HTTP HEAD / responded 404 in 122.7283 ms
2025-01-20 09:21:51.337 +04:00 [INF] Request finished HTTP/1.1 HEAD http://localhost:5192/ - 404 null null 125.6922ms
2025-01-20 09:21:51.340 +04:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: HEAD http://localhost:5192/, Response status code: 404
2025-01-20 09:22:27.892 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 509
2025-01-20 09:22:27.899 +04:00 [INF] CORS policy execution successful.
2025-01-20 09:22:28.047 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 09:22:28.078 +04:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 09:22:28.089 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:22:28.098 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, OnAim.Admin.Contracts.Dtos.Game.CreateGameConfigurationTemplateDto) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:22:28.122 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:22:28.328 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:22:33.434 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 5332.2411ms
2025-01-20 09:22:33.436 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:23:08.868 +04:00 [ERR] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 500 in 40972.5651 ms
2025-01-20 09:23:08.871 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 500 null application/json 40979.1877ms
2025-01-20 09:24:28.177 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 09:24:28.337 +04:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:24:28.349 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:24:28.376 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:24:28.508 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:24:28.509 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:24:28.517 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 09:24:28.554 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 09:24:28.568 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 09:24:28.684 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 09:24:28.764 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 09:24:28.794 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 09:24:28.795 +04:00 [INF] Hosting environment: Development
2025-01-20 09:24:28.796 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 09:24:29.287 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 09:24:29.406 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 42.6431 ms
2025-01-20 09:24:29.410 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 09:24:29.412 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 09:24:29.412 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 127.6414ms
2025-01-20 09:24:29.416 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 6.2745ms
2025-01-20 09:24:29.433 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 21.8842ms
2025-01-20 09:24:29.450 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 09:24:29.785 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 333.3256 ms
2025-01-20 09:24:29.786 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 336.5646ms
2025-01-20 09:24:50.948 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 509
2025-01-20 09:24:50.962 +04:00 [INF] CORS policy execution successful.
2025-01-20 09:24:50.963 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 09:24:51.204 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 09:24:51.227 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 09:24:51.240 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:24:51.249 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, OnAim.Admin.Contracts.Dtos.Game.CreateGameConfigurationTemplateDto) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:24:51.276 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:24:51.341 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:24:54.264 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 3010.4085ms
2025-01-20 09:24:54.265 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:24:54.325 +04:00 [ERR] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 500 in 3364.8537 ms
2025-01-20 09:24:54.328 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 500 null application/json 3379.6858ms
2025-01-20 09:26:49.562 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 09:26:49.854 +04:00 [INF] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:26:49.865 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:26:49.889 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:26:49.908 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:26:49.910 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:26:49.916 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 09:26:49.953 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 09:26:49.971 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 09:26:50.155 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 09:26:50.250 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 09:26:50.283 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 09:26:50.284 +04:00 [INF] Hosting environment: Development
2025-01-20 09:26:50.285 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 09:26:50.869 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 09:26:50.976 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 34.1309 ms
2025-01-20 09:26:50.978 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 09:26:50.979 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 113.4232ms
2025-01-20 09:26:50.982 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 3.9282ms
2025-01-20 09:26:50.984 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 09:26:51.006 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 21.9255ms
2025-01-20 09:26:51.024 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 09:26:51.420 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 394.4214 ms
2025-01-20 09:26:51.421 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 397.4661ms
2025-01-20 09:27:05.597 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 509
2025-01-20 09:27:05.601 +04:00 [INF] CORS policy execution successful.
2025-01-20 09:27:05.602 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 09:27:05.945 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 09:27:05.968 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 09:27:05.979 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:27:05.987 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, OnAim.Admin.Contracts.Dtos.Game.CreateGameConfigurationTemplateDto) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:27:06.011 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:27:06.193 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:33:13.486 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 09:33:13.674 +04:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:33:13.690 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:33:13.714 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:33:13.736 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:33:13.737 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:33:13.744 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 09:33:13.785 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 09:33:13.804 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 09:33:13.955 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 09:33:14.049 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 09:33:14.090 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 09:33:14.091 +04:00 [INF] Hosting environment: Development
2025-01-20 09:33:14.091 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 09:33:14.479 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 09:33:14.597 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 32.6598 ms
2025-01-20 09:33:14.600 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 09:33:14.601 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 125.0244ms
2025-01-20 09:33:14.603 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 4.3742ms
2025-01-20 09:33:14.604 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 09:33:14.626 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 21.7888ms
2025-01-20 09:33:14.645 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 09:33:15.331 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 684.4170 ms
2025-01-20 09:33:15.332 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 687.5758ms
2025-01-20 09:33:21.580 +04:00 [INF] Request starting HTTP/1.1 HEAD http://localhost:5192/ - null null
2025-01-20 09:33:21.583 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 09:33:21.703 +04:00 [INF] HTTP HEAD / responded 404 in 121.3177 ms
2025-01-20 09:33:21.705 +04:00 [INF] Request finished HTTP/1.1 HEAD http://localhost:5192/ - 404 null null 124.9404ms
2025-01-20 09:33:21.708 +04:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: HEAD http://localhost:5192/, Response status code: 404
2025-01-20 09:33:38.897 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1106
2025-01-20 09:33:38.901 +04:00 [INF] CORS policy execution successful.
2025-01-20 09:33:39.062 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 09:33:39.085 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 09:33:39.096 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:33:39.105 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Object) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:33:39.129 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:33:39.212 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:33:39.328 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 220.3506ms
2025-01-20 09:33:39.329 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:33:39.363 +04:00 [ERR] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 500 in 462.2246 ms
2025-01-20 09:33:39.365 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 500 null application/json 468.6845ms
2025-01-20 09:34:43.413 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 09:34:43.547 +04:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:34:43.558 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:34:43.581 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:34:43.598 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:34:43.600 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:34:43.607 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 09:34:43.642 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 09:34:43.657 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 09:34:43.815 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 09:34:43.900 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 09:34:43.935 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 09:34:43.935 +04:00 [INF] Hosting environment: Development
2025-01-20 09:34:43.936 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 09:34:44.138 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 09:34:44.242 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 41.8632 ms
2025-01-20 09:34:44.243 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 09:34:44.244 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 09:34:44.246 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 113.4908ms
2025-01-20 09:34:44.247 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 4.9542ms
2025-01-20 09:34:44.262 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 18.2268ms
2025-01-20 09:34:44.279 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 09:34:44.622 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 341.7874 ms
2025-01-20 09:34:44.623 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 344.2744ms
2025-01-20 09:34:52.213 +04:00 [INF] Request starting HTTP/1.1 HEAD http://localhost:5192/ - null null
2025-01-20 09:34:52.217 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 09:34:52.352 +04:00 [INF] HTTP HEAD / responded 404 in 137.7675 ms
2025-01-20 09:34:52.354 +04:00 [INF] Request finished HTTP/1.1 HEAD http://localhost:5192/ - 404 null null 142.9165ms
2025-01-20 09:34:52.356 +04:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: HEAD http://localhost:5192/, Response status code: 404
2025-01-20 09:35:13.232 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1106
2025-01-20 09:35:13.241 +04:00 [INF] CORS policy execution successful.
2025-01-20 09:35:13.393 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 09:35:13.418 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 09:35:13.429 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:35:13.438 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Object) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:35:13.463 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:35:13.524 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:35:13.644 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 203.4991ms
2025-01-20 09:35:13.645 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:35:13.680 +04:00 [ERR] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 500 in 444.2432 ms
2025-01-20 09:35:13.682 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 500 null application/json 449.9538ms
2025-01-20 09:43:02.134 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 09:43:02.321 +04:00 [INF] Executed DbCommand (68ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:43:02.332 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:43:02.357 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:43:02.375 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:43:02.376 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:43:02.383 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 09:43:02.421 +04:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 09:43:02.438 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 09:43:02.658 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 09:43:02.756 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 09:43:02.794 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 09:43:02.795 +04:00 [INF] Hosting environment: Development
2025-01-20 09:43:02.796 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 09:43:02.883 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 09:43:02.996 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 39.1115 ms
2025-01-20 09:43:02.999 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 09:43:03.000 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 120.8199ms
2025-01-20 09:43:03.006 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 6.8528ms
2025-01-20 09:43:03.006 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 09:43:03.023 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 16.7726ms
2025-01-20 09:43:03.043 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 09:43:03.512 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 468.1102 ms
2025-01-20 09:43:03.513 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 470.656ms
2025-01-20 09:43:09.840 +04:00 [INF] Request starting HTTP/1.1 HEAD http://localhost:5192/ - null null
2025-01-20 09:43:09.844 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 09:43:10.073 +04:00 [INF] HTTP HEAD / responded 404 in 230.6644 ms
2025-01-20 09:43:10.074 +04:00 [INF] Request finished HTTP/1.1 HEAD http://localhost:5192/ - 404 null null 234.1734ms
2025-01-20 09:43:10.077 +04:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: HEAD http://localhost:5192/, Response status code: 404
2025-01-20 09:43:28.813 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1106
2025-01-20 09:43:28.816 +04:00 [INF] CORS policy execution successful.
2025-01-20 09:43:28.969 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 09:43:28.994 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 09:43:29.006 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:43:29.014 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Object) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:43:29.040 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:43:29.221 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:43:29.344 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 326.8431ms
2025-01-20 09:43:29.345 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:43:29.380 +04:00 [ERR] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 500 in 564.6363 ms
2025-01-20 09:43:29.383 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 500 null application/json 570.5555ms
2025-01-20 09:44:52.939 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 09:44:53.087 +04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:44:53.096 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:44:53.119 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:44:53.136 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:44:53.137 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:44:53.143 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 09:44:53.181 +04:00 [ERR] Failed executing DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 09:44:53.195 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 09:44:53.319 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 09:44:53.404 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 09:44:53.448 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 09:44:53.448 +04:00 [INF] Hosting environment: Development
2025-01-20 09:44:53.450 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 09:44:53.596 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 09:44:53.698 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 35.1645 ms
2025-01-20 09:44:53.703 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 09:44:53.704 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 109.9334ms
2025-01-20 09:44:53.708 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 5.4105ms
2025-01-20 09:44:53.710 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 09:44:53.732 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 22.7309ms
2025-01-20 09:44:53.750 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 09:44:54.090 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 339.1226 ms
2025-01-20 09:44:54.091 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 341.7292ms
2025-01-20 09:45:01.633 +04:00 [INF] Request starting HTTP/1.1 HEAD http://localhost:5192/ - null null
2025-01-20 09:45:01.638 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 09:45:01.766 +04:00 [INF] HTTP HEAD / responded 404 in 130.5104 ms
2025-01-20 09:45:01.768 +04:00 [INF] Request finished HTTP/1.1 HEAD http://localhost:5192/ - 404 null null 134.5343ms
2025-01-20 09:45:01.770 +04:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: HEAD http://localhost:5192/, Response status code: 404
2025-01-20 09:45:10.519 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1106
2025-01-20 09:45:10.523 +04:00 [INF] CORS policy execution successful.
2025-01-20 09:45:10.676 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 09:45:10.699 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 09:45:10.710 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:45:10.719 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Object) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:45:10.744 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:45:10.805 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:45:24.706 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 13984.5492ms
2025-01-20 09:45:24.707 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:47:58.559 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 09:47:58.705 +04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:47:58.714 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:47:58.739 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:47:58.757 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:47:58.759 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:47:58.766 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 09:47:58.806 +04:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 09:47:58.820 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 09:47:58.941 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 09:47:59.032 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 09:47:59.068 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 09:47:59.069 +04:00 [INF] Hosting environment: Development
2025-01-20 09:47:59.070 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 09:47:59.649 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 09:47:59.769 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 42.0531 ms
2025-01-20 09:47:59.771 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 09:47:59.772 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 09:47:59.773 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 126.8991ms
2025-01-20 09:47:59.775 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 4.4978ms
2025-01-20 09:47:59.792 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 19.8124ms
2025-01-20 09:47:59.811 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 09:48:00.196 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 382.3992 ms
2025-01-20 09:48:00.198 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 386.2777ms
2025-01-20 09:48:24.147 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1106
2025-01-20 09:48:24.159 +04:00 [INF] CORS policy execution successful.
2025-01-20 09:48:24.160 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 09:48:24.398 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 09:48:24.423 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 09:48:24.435 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:48:24.444 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Object) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:48:24.470 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:48:24.528 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:48:28.991 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Domain.Entities.Templates.GameConfigurationTemplate'.
2025-01-20 09:48:28.997 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 4550.2736ms
2025-01-20 09:48:28.999 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:48:29.011 +04:00 [INF] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 200 in 4853.7108 ms
2025-01-20 09:48:29.014 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 200 null application/json; charset=utf-8 4867.5366ms
2025-01-20 09:49:21.228 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 09:49:21.240 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 09:49:21.246 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:49:21.276 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:49:21.282 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:49:21.312 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 09:49:21.315 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API) in 68.2652ms
2025-01-20 09:49:21.316 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 09:49:21.318 +04:00 [INF] HTTP GET /api/Games/GetAllGameConfigurationTemplates responded 200 in 85.0716 ms
2025-01-20 09:49:21.319 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - 200 null application/json; charset=utf-8 90.918ms
2025-01-20 09:53:24.448 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 09:53:24.597 +04:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:53:24.607 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:53:24.628 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:53:24.645 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:53:24.646 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:53:24.653 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 09:53:24.688 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 09:53:24.703 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 09:53:24.813 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 09:53:24.889 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 09:53:24.918 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 09:53:24.918 +04:00 [INF] Hosting environment: Development
2025-01-20 09:53:24.919 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 09:53:25.100 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 09:53:25.259 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 37.1955 ms
2025-01-20 09:53:25.260 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 09:53:25.262 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 164.2314ms
2025-01-20 09:53:25.264 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 3.2161ms
2025-01-20 09:53:25.265 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 09:53:25.303 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 38.4702ms
2025-01-20 09:53:25.321 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 09:53:25.644 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 322.1139 ms
2025-01-20 09:53:25.646 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 325.0568ms
2025-01-20 09:53:32.936 +04:00 [INF] Request starting HTTP/1.1 HEAD http://localhost:5192/ - null null
2025-01-20 09:53:32.940 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 09:53:33.057 +04:00 [INF] HTTP HEAD / responded 404 in 118.0833 ms
2025-01-20 09:53:33.058 +04:00 [INF] Request finished HTTP/1.1 HEAD http://localhost:5192/ - 404 null null 122.1949ms
2025-01-20 09:53:33.061 +04:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: HEAD http://localhost:5192/, Response status code: 404
2025-01-20 09:53:51.541 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1106
2025-01-20 09:53:51.546 +04:00 [INF] CORS policy execution successful.
2025-01-20 09:53:51.704 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 09:53:51.728 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 09:53:51.739 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:53:51.747 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Text.Json.JsonElement) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:53:51.772 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:53:51.852 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:53:51.896 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Domain.Entities.Templates.GameConfigurationTemplate'.
2025-01-20 09:53:51.904 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 154.5677ms
2025-01-20 09:53:51.905 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:53:51.908 +04:00 [INF] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 200 in 362.2093 ms
2025-01-20 09:53:51.910 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 200 null application/json; charset=utf-8 368.9021ms
2025-01-20 09:53:59.385 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 09:53:59.394 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 09:53:59.398 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:53:59.429 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:53:59.436 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:53:59.583 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API) in 183.5334ms
2025-01-20 09:53:59.584 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 09:53:59.638 +04:00 [ERR] HTTP GET /api/Games/GetAllGameConfigurationTemplates responded 500 in 247.7679 ms
2025-01-20 09:53:59.639 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - 500 null application/json 254.8827ms
2025-01-20 09:54:42.147 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 09:54:42.288 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:54:42.297 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:54:42.319 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:54:42.457 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:54:42.459 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:54:42.467 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 09:54:42.502 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 09:54:42.516 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 09:54:42.619 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 09:54:42.691 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 09:54:42.719 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 09:54:42.720 +04:00 [INF] Hosting environment: Development
2025-01-20 09:54:42.721 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 09:54:43.083 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 09:54:43.171 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 31.1436 ms
2025-01-20 09:54:43.172 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 09:54:43.175 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 09:54:43.177 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 96.7612ms
2025-01-20 09:54:43.178 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 5.6918ms
2025-01-20 09:54:43.191 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 17.7691ms
2025-01-20 09:54:43.207 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 09:54:43.518 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 309.3977 ms
2025-01-20 09:54:43.519 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 312.2896ms
2025-01-20 09:54:51.012 +04:00 [INF] Request starting HTTP/1.1 HEAD http://localhost:5192/ - null null
2025-01-20 09:54:51.016 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 09:54:51.140 +04:00 [INF] HTTP HEAD / responded 404 in 125.8427 ms
2025-01-20 09:54:51.141 +04:00 [INF] Request finished HTTP/1.1 HEAD http://localhost:5192/ - 404 null null 129.5828ms
2025-01-20 09:54:51.144 +04:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: HEAD http://localhost:5192/, Response status code: 404
2025-01-20 09:54:59.863 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 09:55:00.028 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 09:55:00.052 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 09:55:00.063 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 09:55:00.071 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:55:00.095 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:55:00.152 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:55:00.194 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 09:55:00.202 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API) in 128.478ms
2025-01-20 09:55:00.203 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 09:55:00.207 +04:00 [INF] HTTP GET /api/Games/GetAllGameConfigurationTemplates responded 200 in 338.1188 ms
2025-01-20 09:55:00.209 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - 200 null application/json; charset=utf-8 346.1686ms
2025-01-20 09:55:13.696 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1106
2025-01-20 09:55:13.703 +04:00 [INF] CORS policy execution successful.
2025-01-20 09:55:13.708 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:55:13.711 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Text.Json.JsonElement) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:55:13.741 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:55:13.750 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:55:13.767 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Domain.Entities.Templates.GameConfigurationTemplate'.
2025-01-20 09:55:13.769 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 56.7953ms
2025-01-20 09:55:13.770 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:55:13.771 +04:00 [INF] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 200 in 68.9762 ms
2025-01-20 09:55:13.772 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 200 null application/json; charset=utf-8 76.4097ms
2025-01-20 09:55:18.728 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 09:55:18.732 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 09:55:18.733 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:55:18.738 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:55:18.742 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:55:18.753 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 09:55:18.756 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API) in 20.7057ms
2025-01-20 09:55:18.757 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 09:55:18.824 +04:00 [ERR] HTTP GET /api/Games/GetAllGameConfigurationTemplates responded 500 in 92.8074 ms
2025-01-20 09:55:18.825 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - 500 null application/json 97.4218ms
2025-01-20 09:55:24.216 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 09:55:24.220 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 09:55:24.221 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:55:24.225 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:55:24.228 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:55:24.232 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 09:55:24.234 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API) in 11.3975ms
2025-01-20 09:55:24.235 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 09:55:24.267 +04:00 [ERR] HTTP GET /api/Games/GetAllGameConfigurationTemplates responded 500 in 48.4087 ms
2025-01-20 09:55:24.269 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - 500 null application/json 52.3772ms
2025-01-20 09:55:34.750 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 09:55:34.753 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 09:55:34.754 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:55:34.758 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:55:34.762 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:58:19.198 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 09:58:19.337 +04:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:58:19.345 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:58:19.366 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:58:19.384 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:58:19.385 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:58:19.391 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 09:58:19.425 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 09:58:19.440 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 09:58:19.556 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 09:58:19.633 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 09:58:19.662 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 09:58:19.663 +04:00 [INF] Hosting environment: Development
2025-01-20 09:58:19.663 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 09:58:20.142 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 09:58:20.231 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 32.5464 ms
2025-01-20 09:58:20.234 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 95.563ms
2025-01-20 09:58:20.235 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 09:58:20.237 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 09:58:20.240 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 2.9912ms
2025-01-20 09:58:20.252 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 17.2778ms
2025-01-20 09:58:20.271 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 09:58:20.587 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 314.4720 ms
2025-01-20 09:58:20.588 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 317.1469ms
2025-01-20 09:58:45.412 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1106
2025-01-20 09:58:45.420 +04:00 [INF] CORS policy execution successful.
2025-01-20 09:58:45.422 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 09:58:45.686 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 09:58:45.711 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 09:58:45.722 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:58:45.731 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Object) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:58:45.757 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:58:45.817 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:58:45.895 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Domain.Entities.Templates.GameConfigurationTemplate'.
2025-01-20 09:58:45.928 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 193.415ms
2025-01-20 09:58:45.930 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:58:45.943 +04:00 [INF] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 200 in 523.7234 ms
2025-01-20 09:58:45.945 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 200 null application/json; charset=utf-8 533.5118ms
2025-01-20 09:59:04.417 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1106
2025-01-20 09:59:04.425 +04:00 [INF] CORS policy execution successful.
2025-01-20 09:59:04.432 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:59:04.433 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Object) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:59:04.463 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:59:04.468 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:59:30.607 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 09:59:30.907 +04:00 [INF] Executed DbCommand (78ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:59:30.916 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:59:30.939 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:59:30.958 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 09:59:30.960 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 09:59:30.967 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 09:59:31.007 +04:00 [ERR] Failed executing DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 09:59:31.022 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 09:59:31.140 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 09:59:31.216 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 09:59:31.244 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 09:59:31.244 +04:00 [INF] Hosting environment: Development
2025-01-20 09:59:31.245 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 09:59:31.735 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 09:59:31.841 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 42.9587 ms
2025-01-20 09:59:31.843 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 09:59:31.846 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 09:59:31.848 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 115.6839ms
2025-01-20 09:59:31.850 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 7.3784ms
2025-01-20 09:59:31.870 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 26.5362ms
2025-01-20 09:59:31.889 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 09:59:32.228 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 337.9808 ms
2025-01-20 09:59:32.230 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 340.909ms
2025-01-20 09:59:47.608 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1106
2025-01-20 09:59:47.613 +04:00 [INF] CORS policy execution successful.
2025-01-20 09:59:47.614 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 09:59:47.852 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 09:59:47.877 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 09:59:47.889 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:59:47.897 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Object) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 09:59:47.922 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 09:59:47.981 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 09:59:52.154 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 4254.3297ms
2025-01-20 09:59:52.155 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 09:59:52.217 +04:00 [ERR] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 500 in 4605.5715 ms
2025-01-20 09:59:52.220 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 500 null application/json 4612.2582ms
2025-01-20 10:01:12.118 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 10:01:12.252 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:01:12.260 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:01:12.392 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:01:12.409 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:01:12.411 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:01:12.417 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 10:01:12.452 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 10:01:12.466 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 10:01:12.584 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 10:01:12.663 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 10:01:12.693 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 10:01:12.694 +04:00 [INF] Hosting environment: Development
2025-01-20 10:01:12.694 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 10:01:13.246 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 10:01:13.360 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 52.0375 ms
2025-01-20 10:01:13.362 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 10:01:13.362 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 10:01:13.363 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 120.1282ms
2025-01-20 10:01:13.368 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 5.8666ms
2025-01-20 10:01:13.389 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 26.2749ms
2025-01-20 10:01:13.405 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 10:01:13.808 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 401.5898 ms
2025-01-20 10:01:13.810 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 404.6131ms
2025-01-20 10:01:33.804 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1106
2025-01-20 10:01:33.812 +04:00 [INF] CORS policy execution successful.
2025-01-20 10:01:33.813 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 10:01:34.050 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 10:01:34.074 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 10:01:34.089 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 10:01:34.098 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Object) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 10:01:34.121 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 10:01:34.179 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 10:01:39.821 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Domain.Entities.Templates.GameConfigurationTemplate'.
2025-01-20 10:01:39.864 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 5764.0225ms
2025-01-20 10:01:39.865 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 10:01:39.923 +04:00 [ERR] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 500 in 6112.3723 ms
2025-01-20 10:01:39.925 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 500 null application/json 6121.5962ms
2025-01-20 10:02:49.058 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1086
2025-01-20 10:02:49.065 +04:00 [INF] CORS policy execution successful.
2025-01-20 10:02:49.073 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 10:02:49.074 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Object) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 10:02:49.104 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 10:02:49.107 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 10:02:53.109 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Domain.Entities.Templates.GameConfigurationTemplate'.
2025-01-20 10:02:53.114 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 4039.211ms
2025-01-20 10:02:53.116 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 10:02:53.136 +04:00 [ERR] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 500 in 4072.0981 ms
2025-01-20 10:02:53.137 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 500 null application/json 4078.9844ms
2025-01-20 10:03:05.071 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 10:03:05.206 +04:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:03:05.215 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:03:05.235 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:03:05.252 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:03:05.253 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:03:05.259 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 10:03:05.293 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 10:03:05.306 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 10:03:05.407 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 10:03:05.479 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 10:03:05.508 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 10:03:05.508 +04:00 [INF] Hosting environment: Development
2025-01-20 10:03:05.509 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 10:03:05.901 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 10:03:05.992 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 32.8819 ms
2025-01-20 10:03:05.994 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 10:03:05.996 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 10:03:05.997 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 98.2283ms
2025-01-20 10:03:05.999 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 5.5639ms
2025-01-20 10:03:06.016 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 20.2819ms
2025-01-20 10:03:06.032 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 10:03:06.347 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 313.5171 ms
2025-01-20 10:03:06.349 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 316.7321ms
2025-01-20 10:03:31.462 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1106
2025-01-20 10:03:31.471 +04:00 [INF] CORS policy execution successful.
2025-01-20 10:03:31.472 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 10:03:31.719 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 10:03:31.744 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 10:03:31.756 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 10:03:31.765 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Object) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 10:03:31.790 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 10:03:31.850 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 10:04:24.844 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 10:04:24.981 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:04:24.989 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:04:25.011 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:04:25.029 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:04:25.031 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:04:25.039 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 10:04:25.074 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 10:04:25.089 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 10:04:25.199 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 10:04:25.279 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 10:04:25.311 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 10:04:25.311 +04:00 [INF] Hosting environment: Development
2025-01-20 10:04:25.312 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 10:04:25.470 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 10:04:25.565 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 36.9981 ms
2025-01-20 10:04:25.569 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 10:04:25.573 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 102.1992ms
2025-01-20 10:04:25.575 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 6.4606ms
2025-01-20 10:04:25.575 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 10:04:25.592 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 17.0503ms
2025-01-20 10:04:25.608 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 10:04:25.917 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 307.8121 ms
2025-01-20 10:04:25.919 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 310.8372ms
2025-01-20 10:04:43.589 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1106
2025-01-20 10:04:43.594 +04:00 [INF] CORS policy execution successful.
2025-01-20 10:04:43.595 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 10:04:43.837 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 10:04:43.860 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 10:04:43.872 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 10:04:43.882 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Object) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 10:04:43.909 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 10:04:43.970 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 10:04:44.051 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Domain.Entities.Templates.GameConfigurationTemplate'.
2025-01-20 10:04:44.057 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 171.2652ms
2025-01-20 10:04:44.058 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 10:04:44.070 +04:00 [INF] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 200 in 477.3352 ms
2025-01-20 10:04:44.073 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 200 null application/json; charset=utf-8 484.1111ms
2025-01-20 10:06:49.276 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 10:06:49.292 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:06:49.297 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 10:06:49.327 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 10:06:49.344 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 10:06:52.624 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 10:06:52.627 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API) in 3329.2091ms
2025-01-20 10:06:52.628 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:06:52.630 +04:00 [INF] HTTP GET /api/Games/GetAllGameConfigurationTemplates responded 200 in 3343.9174 ms
2025-01-20 10:06:52.631 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - 200 null application/json; charset=utf-8 3354.7055ms
2025-01-20 10:14:31.178 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 10:14:31.335 +04:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:14:31.348 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:14:31.373 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:14:31.394 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:14:31.396 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:14:31.403 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 10:14:31.442 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 10:14:31.460 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 10:14:31.598 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 10:14:31.705 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 10:14:31.754 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 10:14:31.758 +04:00 [INF] Hosting environment: Development
2025-01-20 10:14:31.762 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 10:14:31.886 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 10:14:31.985 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 31.9697 ms
2025-01-20 10:14:31.986 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 10:14:31.987 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 10:14:31.988 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 103.9487ms
2025-01-20 10:14:31.990 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 3.7395ms
2025-01-20 10:14:32.004 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 16.2488ms
2025-01-20 10:14:32.025 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 10:14:32.332 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 305.6671 ms
2025-01-20 10:14:32.334 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 309.5635ms
2025-01-20 10:14:47.995 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 10:14:48.001 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 10:14:48.246 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 10:14:48.270 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 10:14:48.281 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:14:48.290 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 10:14:48.316 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 10:14:48.375 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 10:14:48.461 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 10:14:48.471 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API) in 177.7036ms
2025-01-20 10:14:48.473 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:14:48.503 +04:00 [INF] HTTP GET /api/Games/GetAllGameConfigurationTemplates responded 200 in 504.0514 ms
2025-01-20 10:14:48.506 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - 200 null application/json; charset=utf-8 510.4898ms
2025-01-20 10:15:36.869 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 10:15:37.009 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:15:37.018 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:15:37.040 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:15:37.058 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:15:37.060 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:15:37.067 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 10:15:37.101 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 10:15:37.115 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 10:15:37.222 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 10:15:37.295 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 10:15:37.324 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 10:15:37.324 +04:00 [INF] Hosting environment: Development
2025-01-20 10:15:37.325 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 10:15:37.603 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 10:15:37.696 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 31.7966 ms
2025-01-20 10:15:37.697 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 10:15:37.699 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 10:15:37.700 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 99.8584ms
2025-01-20 10:15:37.701 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 4.0797ms
2025-01-20 10:15:37.717 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 18.5611ms
2025-01-20 10:15:37.734 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 10:15:38.047 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 311.9996 ms
2025-01-20 10:15:38.048 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 314.7102ms
2025-01-20 10:15:47.308 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 10:15:47.313 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 10:15:47.555 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 10:15:47.578 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 10:15:47.590 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:15:47.599 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 10:15:47.629 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 10:15:47.688 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 10:15:47.772 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 10:15:47.781 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API) in 178.078ms
2025-01-20 10:15:47.782 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:15:47.813 +04:00 [INF] HTTP GET /api/Games/GetAllGameConfigurationTemplates responded 200 in 501.4232 ms
2025-01-20 10:15:47.816 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - 200 null application/json; charset=utf-8 508.5751ms
2025-01-20 10:16:00.966 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 10:16:00.980 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:16:00.981 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 10:16:01.012 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 10:16:01.016 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 10:16:03.926 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 10:16:03.927 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API) in 2945.7461ms
2025-01-20 10:16:03.929 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:16:03.931 +04:00 [INF] HTTP GET /api/Games/GetAllGameConfigurationTemplates responded 200 in 2959.9552 ms
2025-01-20 10:16:03.932 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - 200 null application/json; charset=utf-8 2967.0379ms
2025-01-20 10:16:04.777 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 10:16:04.781 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:16:04.783 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 10:16:04.787 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 10:16:04.790 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 10:16:39.388 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 10:16:39.401 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API) in 34616.3863ms
2025-01-20 10:16:39.407 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:16:39.410 +04:00 [INF] HTTP GET /api/Games/GetAllGameConfigurationTemplates responded 200 in 34630.1648 ms
2025-01-20 10:16:39.411 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - 200 null application/json; charset=utf-8 34634.0163ms
2025-01-20 10:16:58.024 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 10:16:58.161 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:16:58.169 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:16:58.190 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:16:58.206 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:16:58.207 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:16:58.215 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 10:16:58.249 +04:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 10:16:58.262 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 10:16:58.367 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 10:16:58.439 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 10:16:58.470 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 10:16:58.471 +04:00 [INF] Hosting environment: Development
2025-01-20 10:16:58.471 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 10:16:58.742 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 10:16:58.834 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 31.4471 ms
2025-01-20 10:16:58.837 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 10:16:58.837 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 97.6833ms
2025-01-20 10:16:58.840 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 3.4675ms
2025-01-20 10:16:58.841 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 10:16:58.857 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 16.1125ms
2025-01-20 10:16:58.873 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 10:16:59.185 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 310.3526 ms
2025-01-20 10:16:59.186 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 313.2324ms
2025-01-20 10:17:13.278 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 10:17:13.285 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 10:17:13.527 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 10:17:13.551 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 10:17:13.563 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:17:13.572 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 10:17:13.597 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 10:17:13.654 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 10:17:15.055 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 10:17:15.062 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API) in 1487.9646ms
2025-01-20 10:17:15.063 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:17:15.093 +04:00 [INF] HTTP GET /api/Games/GetAllGameConfigurationTemplates responded 200 in 1811.0913 ms
2025-01-20 10:17:15.096 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - 200 null application/json; charset=utf-8 1818.4286ms
2025-01-20 10:18:29.619 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 10:18:29.754 +04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:18:29.763 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:18:29.783 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:18:29.914 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:18:29.917 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:18:29.923 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 10:18:29.959 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 10:18:29.974 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 10:18:30.085 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 10:18:30.164 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 10:18:30.202 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 10:18:30.202 +04:00 [INF] Hosting environment: Development
2025-01-20 10:18:30.203 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 10:18:30.297 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 10:18:30.390 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 32.7205 ms
2025-01-20 10:18:30.392 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 10:18:30.392 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 10:18:30.394 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 99.6999ms
2025-01-20 10:18:30.395 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 3.3254ms
2025-01-20 10:18:30.409 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 16.5284ms
2025-01-20 10:18:30.428 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 10:18:30.742 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 312.3499 ms
2025-01-20 10:18:30.744 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 315.4731ms
2025-01-20 10:18:40.774 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 10:18:40.780 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 10:18:41.026 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 10:18:41.048 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 10:18:41.061 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:18:41.070 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 10:18:41.094 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 10:18:41.151 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 10:18:41.236 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 10:18:41.244 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API) in 171.5232ms
2025-01-20 10:18:41.245 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:18:41.273 +04:00 [INF] HTTP GET /api/Games/GetAllGameConfigurationTemplates responded 200 in 495.3631 ms
2025-01-20 10:18:41.276 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - 200 null application/json; charset=utf-8 501.6281ms
2025-01-20 10:20:12.824 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 10:20:12.967 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:20:12.976 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:20:13.000 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:20:13.019 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:20:13.020 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:20:13.027 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 10:20:13.077 +04:00 [ERR] Failed executing DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 10:20:13.091 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 10:20:13.205 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 10:20:13.280 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 10:20:13.310 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 10:20:13.311 +04:00 [INF] Hosting environment: Development
2025-01-20 10:20:13.312 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 10:20:13.752 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 10:20:13.843 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 33.2723 ms
2025-01-20 10:20:13.846 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 10:20:13.846 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 10:20:13.849 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 100.2813ms
2025-01-20 10:20:13.851 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 6.0047ms
2025-01-20 10:20:13.866 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 20.2566ms
2025-01-20 10:20:13.882 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 10:20:14.202 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 319.0549 ms
2025-01-20 10:20:14.205 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 323.6449ms
2025-01-20 10:20:27.864 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 10:20:27.871 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 10:20:28.114 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 10:20:28.138 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 10:20:28.150 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:20:28.159 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 10:20:28.183 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 10:20:28.240 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 10:20:28.317 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 10:20:28.326 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API) in 164.5869ms
2025-01-20 10:20:28.328 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:20:28.358 +04:00 [INF] HTTP GET /api/Games/GetAllGameConfigurationTemplates responded 200 in 488.8065 ms
2025-01-20 10:20:28.361 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - 200 null application/json; charset=utf-8 496.5978ms
2025-01-20 10:38:53.275 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 10:38:53.412 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:38:53.421 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:38:53.442 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:38:53.459 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:38:53.460 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:38:53.466 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 10:38:53.509 +04:00 [ERR] Failed executing DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 10:38:53.523 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 10:38:53.678 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 10:38:53.764 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 10:38:53.793 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 10:38:53.794 +04:00 [INF] Hosting environment: Development
2025-01-20 10:38:53.795 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 10:38:54.390 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 10:38:54.501 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 38.0697 ms
2025-01-20 10:38:54.506 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 118.1084ms
2025-01-20 10:38:54.508 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 10:38:54.512 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 10:38:54.514 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 6.8557ms
2025-01-20 10:38:54.536 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 24.4336ms
2025-01-20 10:38:54.552 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 10:38:54.952 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 398.4242 ms
2025-01-20 10:38:54.955 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 402.7509ms
2025-01-20 10:39:15.116 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - application/json 1106
2025-01-20 10:39:15.125 +04:00 [INF] CORS policy execution successful.
2025-01-20 10:39:15.126 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 10:39:15.365 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 10:39:15.390 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 10:39:15.401 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 10:39:15.409 +04:00 [INF] Route matched with {action = "CreateGameConfigurationTemplate", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGameConfigurationTemplate(System.String, System.Object) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 10:39:15.436 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 10:39:15.500 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 10:39:17.509 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API) in 2096.7719ms
2025-01-20 10:39:17.511 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.CreateGameConfigurationTemplate (OnAim.Admin.API)'
2025-01-20 10:39:17.574 +04:00 [ERR] HTTP POST /api/Games/CreateGameConfigurationTemplate responded 500 in 2450.8380 ms
2025-01-20 10:39:17.577 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Games/CreateGameConfigurationTemplate?gameName=wheel - 500 null application/json 2460.9321ms
2025-01-20 10:44:01.344 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 10:44:01.479 +04:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:44:01.487 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:44:01.509 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:44:01.526 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 10:44:01.528 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 10:44:01.534 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 10:44:01.569 +04:00 [ERR] Failed executing DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 10:44:01.584 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 10:44:01.704 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 10:44:01.779 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 10:44:01.806 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 10:44:01.807 +04:00 [INF] Hosting environment: Development
2025-01-20 10:44:01.808 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 10:44:02.389 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 10:44:02.515 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 46.0798 ms
2025-01-20 10:44:02.517 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 10:44:02.518 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 10:44:02.522 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 136.0324ms
2025-01-20 10:44:02.523 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 5.9958ms
2025-01-20 10:44:02.543 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 25.6957ms
2025-01-20 10:44:02.566 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 10:44:02.959 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 391.4069 ms
2025-01-20 10:44:02.962 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 396.2783ms
2025-01-20 10:44:17.558 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - null null
2025-01-20 10:44:17.566 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 10:44:17.818 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 10:44:17.841 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 10:44:17.852 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:44:17.861 +04:00 [INF] Route matched with {action = "GetAllGameConfigurationTemplates", controller = "Games"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGameConfigurationTemplates(OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.GamesController (OnAim.Admin.API).
2025-01-20 10:44:17.887 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 10:44:17.945 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 10:44:18.022 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 10:44:18.028 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API) in 164.3265ms
2025-01-20 10:44:18.029 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.GamesController.GetAllGameConfigurationTemplates (OnAim.Admin.API)'
2025-01-20 10:44:18.058 +04:00 [INF] HTTP GET /api/Games/GetAllGameConfigurationTemplates responded 200 in 493.6184 ms
2025-01-20 10:44:18.060 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Games/GetAllGameConfigurationTemplates - 200 null application/json; charset=utf-8 502.4135ms
2025-01-20 11:34:11.674 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 11:34:11.854 +04:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 11:34:11.864 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 11:34:11.889 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 11:34:11.907 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 11:34:11.908 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 11:34:11.916 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 11:34:11.955 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 11:34:11.968 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 11:34:12.100 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 11:34:12.173 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 11:34:12.205 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 11:34:12.206 +04:00 [INF] Hosting environment: Development
2025-01-20 11:34:12.207 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 11:34:12.377 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 11:34:12.492 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 37.7696 ms
2025-01-20 11:34:12.493 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 11:34:12.494 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 11:34:12.496 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 121.2518ms
2025-01-20 11:34:12.498 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 4.6908ms
2025-01-20 11:34:12.519 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 24.7672ms
2025-01-20 11:34:12.541 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 11:34:12.963 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 420.2611 ms
2025-01-20 11:34:12.965 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 423.5017ms
2025-01-20 13:00:14.143 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 13:00:14.279 +04:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:00:14.288 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:00:14.308 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:00:14.325 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:00:14.326 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:00:14.333 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 13:00:14.367 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 13:00:14.381 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 13:00:14.486 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 13:00:14.560 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 13:00:14.587 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 13:00:14.589 +04:00 [INF] Hosting environment: Development
2025-01-20 13:00:14.589 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 13:00:14.963 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 13:00:15.076 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 37.6584 ms
2025-01-20 13:00:15.077 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 13:00:15.080 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 13:00:15.082 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 121.9123ms
2025-01-20 13:00:15.082 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 5.0364ms
2025-01-20 13:00:15.098 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 18.5569ms
2025-01-20 13:00:15.115 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 13:00:15.478 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 361.8199 ms
2025-01-20 13:00:15.482 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 367.6155ms
2025-01-20 13:00:40.081 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Admin/GetSettings - null null
2025-01-20 13:00:40.091 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 13:00:40.120 +04:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '1/17/2025 7:45:20 AM', Current time (UTC): '1/20/2025 9:00:40 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-01-20 13:00:40.123 +04:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '1/17/2025 7:45:20 AM', Current time (UTC): '1/20/2025 9:00:40 AM'.
2025-01-20 13:00:40.125 +04:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '1/17/2025 7:45:20 AM', Current time (UTC): '1/20/2025 9:00:40 AM'.
2025-01-20 13:00:40.127 +04:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-01-20 13:00:40.130 +04:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-01-20 13:00:40.131 +04:00 [INF] HTTP GET /api/Admin/GetSettings responded 401 in 41.4089 ms
2025-01-20 13:00:40.132 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Admin/GetSettings - 401 0 null 51.0998ms
2025-01-20 13:01:00.380 +04:00 [INF] Request starting HTTP/1.1 POST http://localhost:5192/api/Users/Login - application/json 64
2025-01-20 13:01:00.387 +04:00 [INF] CORS policy execution successful.
2025-01-20 13:01:00.390 +04:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '1/17/2025 7:45:20 AM', Current time (UTC): '1/20/2025 9:01:00 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-01-20 13:01:00.391 +04:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '1/17/2025 7:45:20 AM', Current time (UTC): '1/20/2025 9:01:00 AM'.
2025-01-20 13:01:00.392 +04:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '1/17/2025 7:45:20 AM', Current time (UTC): '1/20/2025 9:01:00 AM'.
2025-01-20 13:01:00.470 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.UsersController.Login (OnAim.Admin.API)'
2025-01-20 13:01:00.479 +04:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[OnAim.Admin.Contracts.Dtos.User.AuthResultDto] Login(OnAim.Admin.Contracts.Dtos.User.LoginUserRequest) on controller OnAim.Admin.API.Controllers.UsersController (OnAim.Admin.API).
2025-01-20 13:01:00.596 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:01:00.642 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."Name", a."Value"
FROM "AppSettings" AS a
2025-01-20 13:01:00.694 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__model_Email_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."CreatedBy", u."DateCreated", u."DateDeleted", u."DateOfBirth", u."DateUpdated", u."Email", u."FirstName", u."IsActive", u."IsDeleted", u."IsSuperAdmin", u."IsTwoFactorEnabled", u."IsVerified", u."LastLogin", u."LastName", u."Password", u."Phone", u."PreferencesJson", u."Salt", u."Username", u."VerificationCode", u."VerificationCodeExpiration", u."VerificationPurpose"
FROM "Users" AS u
WHERE u."Email" = @__model_Email_0 AND NOT (u."IsDeleted")
LIMIT 1
2025-01-20 13:01:00.778 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 13:01:00.788 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."UserId", u."RoleId", u."IsActive", r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name", t0."RoleId", t0."EndpointGroupId", t0."IsActive", t0."Id", t0."CreatedBy", t0."DateCreated", t0."DateDeleted", t0."DateUpdated", t0."Description", t0."IsActive0", t0."IsDeleted", t0."Name", t0."EndpointGroupId0", t0."EndpointId", t0."IsActive1", t0."Id0", t0."CreatedBy0", t0."DateCreated0", t0."DateDeleted0", t0."DateUpdated0", t0."Description0", t0."IsActive00", t0."IsDeleted0", t0."Name0", t0."Path", t0."Type"
FROM "UserRoles" AS u
INNER JOIN "Roles" AS r ON u."RoleId" = r."Id"
LEFT JOIN (
    SELECT r0."RoleId", r0."EndpointGroupId", r0."IsActive", e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive" AS "IsActive0", e."IsDeleted", e."Name", t."EndpointGroupId" AS "EndpointGroupId0", t."EndpointId", t."IsActive" AS "IsActive1", t."Id" AS "Id0", t."CreatedBy" AS "CreatedBy0", t."DateCreated" AS "DateCreated0", t."DateDeleted" AS "DateDeleted0", t."DateUpdated" AS "DateUpdated0", t."Description" AS "Description0", t."IsActive0" AS "IsActive00", t."IsDeleted" AS "IsDeleted0", t."Name" AS "Name0", t."Path", t."Type"
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    LEFT JOIN (
        SELECT e0."EndpointGroupId", e0."EndpointId", e0."IsActive", e1."Id", e1."CreatedBy", e1."DateCreated", e1."DateDeleted", e1."DateUpdated", e1."Description", e1."IsActive" AS "IsActive0", e1."IsDeleted", e1."Name", e1."Path", e1."Type"
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
    ) AS t ON e."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE u."UserId" = @__userId_0
ORDER BY u."UserId", u."RoleId", r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."EndpointId"
2025-01-20 13:01:00.910 +04:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?', @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "RefreshTokens" ("DateCreated", "DateDeleted", "DateUpdated", "Expiration", "IsActive", "IsDeleted", "IsRevoked", "Token", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8)
RETURNING "Id";
2025-01-20 13:01:00.931 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AccessTokens" ("DateCreated", "DateDeleted", "DateUpdated", "Expiration", "IsActive", "IsDeleted", "Token", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7)
RETURNING "Id";
2025-01-20 13:01:00.940 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLogin" = @p0
WHERE "Id" = @p1;
2025-01-20 13:01:00.946 +04:00 [INF] Executing ObjectResult, writing value of type 'OnAim.Admin.Contracts.Dtos.User.AuthResultDto'.
2025-01-20 13:01:00.951 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.UsersController.Login (OnAim.Admin.API) in 469.3149ms
2025-01-20 13:01:00.952 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.UsersController.Login (OnAim.Admin.API)'
2025-01-20 13:01:00.971 +04:00 [INF] HTTP POST /api/Users/Login responded 401 in 587.4433 ms
2025-01-20 13:01:00.974 +04:00 [INF] Request finished HTTP/1.1 POST http://localhost:5192/api/Users/Login - 401 null application/json; charset=utf-8 593.559ms
2025-01-20 13:01:50.808 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetAllPromotion - null null
2025-01-20 13:01:50.873 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 13:01:50.880 +04:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 13:01:50.885 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetAllPromotion (OnAim.Admin.API)'
2025-01-20 13:01:50.889 +04:00 [INF] Route matched with {action = "GetAllPromotion", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllPromotion(OnAim.Admin.Contracts.Dtos.Promotion.PromotionFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:01:50.894 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:01:50.921 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:01:51.170 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Promotions" AS p
2025-01-20 13:01:51.178 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:01:51.179 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:01:51.187 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 13:01:51.702 +04:00 [INF] Executed DbCommand (512ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", t."Description", t.c, t."StartDate", t."EndDate", t0."Id", t0."PromotionId", t0."SegmentId", c."Id", c."Name", c."Description", c."ImageUrl", c."CoinType"::int, p1."Url", p1."Id"
FROM (
    SELECT p."Id", p."Title", p."Description", p."Status"::int AS c, p."StartDate", p."EndDate"
    FROM "Promotions" AS p
    LIMIT @__p_1 OFFSET @__p_0
) AS t
LEFT JOIN (
    SELECT s."Id", p0."PromotionId", p0."SegmentId"
    FROM "PromotionSegmentMappings" AS p0
    INNER JOIN "Segments" AS s ON p0."SegmentId" = s."Id"
) AS t0 ON t."Id" = t0."PromotionId"
LEFT JOIN "Coins" AS c ON t."Id" = c."PromotionId"
LEFT JOIN "PromotionViews" AS p1 ON t."Id" = p1."PromotionId"
ORDER BY t."Id", t0."PromotionId", t0."SegmentId", t0."Id", c."Id"
2025-01-20 13:01:51.707 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 13:01:51.721 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetAllPromotion (OnAim.Admin.API) in 831.5036ms
2025-01-20 13:01:51.723 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetAllPromotion (OnAim.Admin.API)'
2025-01-20 13:01:51.724 +04:00 [INF] HTTP GET /api/Promotion/GetAllPromotion responded 200 in 914.7676 ms
2025-01-20 13:01:51.725 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetAllPromotion - 200 null application/json; charset=utf-8 917.4575ms
2025-01-20 13:01:58.813 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionById?id=2 - null null
2025-01-20 13:01:58.820 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionById (OnAim.Admin.API)'
2025-01-20 13:01:58.822 +04:00 [INF] Route matched with {action = "GetPromotionById", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionById(Int32) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:01:58.825 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:01:58.830 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:02:00.637 +04:00 [INF] Executed DbCommand (283ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CreateDate", t."CreatedByUserId", t."DateDeleted", t."Description", t."EndDate", t."FromTemplateId", t."IsDeleted", t."StartDate", t."Status", t."Title", t."TotalCost", t0."Id", t0."CreatedByUserId", t0."Description", t0."IsDeleted", t0."PriorityLevel", t0."PromotionId", t0."SegmentId"
FROM (
    SELECT p."Id", p."CreateDate", p."CreatedByUserId", p."DateDeleted", p."Description", p."EndDate", p."FromTemplateId", p."IsDeleted", p."StartDate", p."Status", p."Title", p."TotalCost"
    FROM "Promotions" AS p
    WHERE p."Id" = @__id_0
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT s."Id", s."CreatedByUserId", s."Description", s."IsDeleted", s."PriorityLevel", p0."PromotionId", p0."SegmentId"
    FROM "PromotionSegmentMappings" AS p0
    INNER JOIN "Segments" AS s ON p0."SegmentId" = s."Id"
) AS t0 ON t."Id" = t0."PromotionId"
ORDER BY t."Id", t0."PromotionId", t0."SegmentId"
2025-01-20 13:02:08.424 +04:00 [ERR] Failed executing DbCommand (13ms) [Parameters=[@__promotion_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."CoinType", c."DateDeleted", c."Description", c."FromTemplateId", c."ImageUrl", c."IsDeleted", c."Name", c."PromotionId", c."Value"
FROM "Coins" AS c
WHERE c."PromotionId" = @__promotion_Id_0
2025-01-20 13:02:08.428 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.Hub.ReadOnlyDataContext'.
Npgsql.PostgresException (0x80004005): 42703: column c.Value does not exist

POSITION: 140
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.<>c.<MoveNext>b__21_0(DbContext _, Enumerator enumerator)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.Value does not exist
    Position: 140
    File: parse_relation.c
    Line: 3727
    Routine: errorMissingColumn
Npgsql.PostgresException (0x80004005): 42703: column c.Value does not exist

POSITION: 140
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.<>c.<MoveNext>b__21_0(DbContext _, Enumerator enumerator)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
  Exception data:
    Severity: ERROR
    SqlState: 42703
    MessageText: column c.Value does not exist
    Position: 140
    File: parse_relation.c
    Line: 3727
    Routine: errorMissingColumn
2025-01-20 13:02:08.504 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionById (OnAim.Admin.API) in 9680.6734ms
2025-01-20 13:02:08.505 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionById (OnAim.Admin.API)'
2025-01-20 13:02:08.546 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionById responded 500 in 9727.9527 ms
2025-01-20 13:02:08.547 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionById?id=2 - 500 null application/json 9733.8127ms
2025-01-20 13:03:36.731 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 13:03:36.875 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:03:36.884 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:03:36.905 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:03:36.923 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:03:36.924 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:03:36.931 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 13:03:36.965 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 13:03:36.979 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 13:03:37.091 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 13:03:37.175 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 13:03:37.204 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 13:03:37.205 +04:00 [INF] Hosting environment: Development
2025-01-20 13:03:37.205 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 13:03:37.362 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 13:03:37.455 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 33.0195 ms
2025-01-20 13:03:37.458 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 13:03:37.458 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 13:03:37.464 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 105.0659ms
2025-01-20 13:03:37.465 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 7.2132ms
2025-01-20 13:03:37.479 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 20.6908ms
2025-01-20 13:03:37.496 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 13:03:37.815 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 318.2568 ms
2025-01-20 13:03:37.818 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 322.7209ms
2025-01-20 13:04:08.104 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionById?id=2 - null null
2025-01-20 13:04:08.112 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 13:04:08.342 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 13:04:08.364 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 13:04:08.377 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionById (OnAim.Admin.API)'
2025-01-20 13:04:08.385 +04:00 [INF] Route matched with {action = "GetPromotionById", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionById(Int32) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:04:08.411 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:04:08.472 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:04:10.405 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CreateDate", t."CreatedByUserId", t."DateDeleted", t."Description", t."EndDate", t."FromTemplateId", t."IsDeleted", t."StartDate", t."Status", t."Title", t."TotalCost", t0."Id", t0."CreatedByUserId", t0."Description", t0."IsDeleted", t0."PriorityLevel", t0."PromotionId", t0."SegmentId"
FROM (
    SELECT p."Id", p."CreateDate", p."CreatedByUserId", p."DateDeleted", p."Description", p."EndDate", p."FromTemplateId", p."IsDeleted", p."StartDate", p."Status", p."Title", p."TotalCost"
    FROM "Promotions" AS p
    WHERE p."Id" = @__id_0
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT s."Id", s."CreatedByUserId", s."Description", s."IsDeleted", s."PriorityLevel", p0."PromotionId", p0."SegmentId"
    FROM "PromotionSegmentMappings" AS p0
    INNER JOIN "Segments" AS s ON p0."SegmentId" = s."Id"
) AS t0 ON t."Id" = t0."PromotionId"
ORDER BY t."Id", t0."PromotionId", t0."SegmentId"
2025-01-20 13:04:11.326 +04:00 [INF] Executed DbCommand (23ms) [Parameters=[@__promotion_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."CoinType", c."DateDeleted", c."Description", c."FromTemplateId", c."ImageUrl", c."IsDeleted", c."Name", c."PromotionId", c."AssetCoin_Value"
FROM "Coins" AS c
WHERE c."PromotionId" = @__promotion_Id_0
2025-01-20 13:04:12.726 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 13:04:12.743 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionById (OnAim.Admin.API) in 4354.4667ms
2025-01-20 13:04:12.745 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionById (OnAim.Admin.API)'
2025-01-20 13:04:12.764 +04:00 [INF] HTTP GET /api/Promotion/GetPromotionById responded 200 in 4653.9288 ms
2025-01-20 13:04:12.767 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionById?id=2 - 200 null application/json; charset=utf-8 4663.4827ms
2025-01-20 13:48:00.768 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 13:48:00.924 +04:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:48:00.933 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:48:00.956 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:48:00.977 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:48:00.979 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:48:00.987 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 13:48:01.026 +04:00 [ERR] Failed executing DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 13:48:01.040 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 13:48:01.176 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 13:48:01.306 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 13:48:01.335 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 13:48:01.335 +04:00 [INF] Hosting environment: Development
2025-01-20 13:48:01.336 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 13:48:01.659 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 13:48:01.777 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 39.4559 ms
2025-01-20 13:48:01.778 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 13:48:01.779 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 13:48:01.780 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 123.5558ms
2025-01-20 13:48:01.782 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 3.5404ms
2025-01-20 13:48:01.804 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 24.5166ms
2025-01-20 13:48:01.824 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 13:48:02.268 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 441.7430 ms
2025-01-20 13:48:02.269 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 444.8978ms
2025-01-20 13:48:20.030 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetAllPromotion - null null
2025-01-20 13:48:20.036 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 13:48:20.275 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 13:48:20.299 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 13:48:20.310 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetAllPromotion (OnAim.Admin.API)'
2025-01-20 13:48:20.320 +04:00 [INF] Route matched with {action = "GetAllPromotion", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllPromotion(OnAim.Admin.Contracts.Dtos.Promotion.PromotionFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:48:20.345 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:48:20.430 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:48:23.014 +04:00 [ERR] An error occurred using the connection to database 'OnAimHub' on server 'tcp://hubdb:5433'.
2025-01-20 13:48:23.020 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.Hub.ReadOnlyDataContext'.
System.Net.Sockets.SocketException (11001): No such host is known.
   at System.Net.NameResolutionPal.ProcessResult(SocketError errorCode, GetAddrInfoExContext* context)
   at System.Net.NameResolutionPal.GetAddressInfoExCallback(Int32 error, Int32 bytes, NativeOverlapped* overlapped)
--- End of stack trace from previous location ---
   at System.Net.Dns.<GetAddrInfoWithTelemetryAsync>g__CompleteAsync|34_0[T](Task task, String hostName, Int64 startingTimestamp)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync[TResult](Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.Net.Sockets.SocketException (11001): No such host is known.
   at System.Net.NameResolutionPal.ProcessResult(SocketError errorCode, GetAddrInfoExContext* context)
   at System.Net.NameResolutionPal.GetAddressInfoExCallback(Int32 error, Int32 bytes, NativeOverlapped* overlapped)
--- End of stack trace from previous location ---
   at System.Net.Dns.<GetAddrInfoWithTelemetryAsync>g__CompleteAsync|34_0[T](Task task, String hostName, Int64 startingTimestamp)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync[TResult](Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 13:48:23.145 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetAllPromotion (OnAim.Admin.API) in 2822.4462ms
2025-01-20 13:48:23.147 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetAllPromotion (OnAim.Admin.API)'
2025-01-20 13:48:23.223 +04:00 [ERR] HTTP GET /api/Promotion/GetAllPromotion responded 500 in 3189.3043 ms
2025-01-20 13:48:23.225 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetAllPromotion - 500 null application/json 3195.4805ms
2025-01-20 13:48:34.489 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 13:48:34.623 +04:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:48:34.632 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:48:34.653 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:48:34.670 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:48:34.671 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:48:34.677 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 13:48:34.711 +04:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 13:48:34.725 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 13:48:34.828 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 13:48:34.907 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 13:48:34.935 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 13:48:34.935 +04:00 [INF] Hosting environment: Development
2025-01-20 13:48:34.936 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 13:48:35.276 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 13:48:35.375 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 36.3151 ms
2025-01-20 13:48:35.377 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 13:48:35.378 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 13:48:35.379 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 106.8173ms
2025-01-20 13:48:35.380 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 3.3328ms
2025-01-20 13:48:35.397 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 18.9373ms
2025-01-20 13:48:35.415 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 13:48:35.764 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 347.7131 ms
2025-01-20 13:48:35.766 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 350.8908ms
2025-01-20 13:48:52.856 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetAllPromotion - null null
2025-01-20 13:48:52.861 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 13:48:53.098 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 13:48:53.123 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 13:48:53.136 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetAllPromotion (OnAim.Admin.API)'
2025-01-20 13:48:53.146 +04:00 [INF] Route matched with {action = "GetAllPromotion", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllPromotion(OnAim.Admin.Contracts.Dtos.Promotion.PromotionFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:48:53.171 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:48:53.232 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:48:53.624 +04:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Promotions" AS p
2025-01-20 13:48:53.633 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:48:53.634 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:48:53.642 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 13:48:54.180 +04:00 [INF] Executed DbCommand (535ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", t."Description", t.c, t."StartDate", t."EndDate", t0."Id", t0."PromotionId", t0."SegmentId", c."Id", c."Name", c."Description", c."ImageUrl", c."CoinType"::int, p1."Url", p1."Id"
FROM (
    SELECT p."Id", p."Title", p."Description", p."Status"::int AS c, p."StartDate", p."EndDate"
    FROM "Promotions" AS p
    LIMIT @__p_1 OFFSET @__p_0
) AS t
LEFT JOIN (
    SELECT s."Id", p0."PromotionId", p0."SegmentId"
    FROM "PromotionSegmentMappings" AS p0
    INNER JOIN "Segments" AS s ON p0."SegmentId" = s."Id"
) AS t0 ON t."Id" = t0."PromotionId"
LEFT JOIN "Coins" AS c ON t."Id" = c."PromotionId"
LEFT JOIN "PromotionViews" AS p1 ON t."Id" = p1."PromotionId"
ORDER BY t."Id", t0."PromotionId", t0."SegmentId", t0."Id", c."Id"
2025-01-20 13:48:54.190 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 13:48:54.208 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetAllPromotion (OnAim.Admin.API) in 1059.1505ms
2025-01-20 13:48:54.209 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetAllPromotion (OnAim.Admin.API)'
2025-01-20 13:48:54.228 +04:00 [INF] HTTP GET /api/Promotion/GetAllPromotion responded 200 in 1368.2179 ms
2025-01-20 13:48:54.230 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetAllPromotion - 200 null application/json; charset=utf-8 1374.5615ms
2025-01-20 13:49:01.077 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 13:49:01.089 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:49:01.092 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:49:01.097 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:49:01.103 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:49:03.155 +04:00 [INF] Executed DbCommand (24ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 13:49:06.273 +04:00 [INF] Executed DbCommand (10ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 13:49:11.729 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:49:11.730 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:49:11.773 +04:00 [INF] Executed DbCommand (39ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", 0 AS "Place", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 13:49:11.780 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method239(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method239(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 13:49:11.831 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 10737.2719ms
2025-01-20 13:49:11.832 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:49:11.870 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionLeaderboards/2 responded 500 in 10787.1928 ms
2025-01-20 13:49:11.871 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - 500 null application/json 10793.302ms
2025-01-20 13:49:21.483 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 13:49:21.495 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:49:21.496 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:49:21.499 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:49:21.506 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:49:23.165 +04:00 [INF] Executed DbCommand (168ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 13:49:26.112 +04:00 [INF] Executed DbCommand (11ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 13:49:31.580 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:49:31.581 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:49:31.623 +04:00 [INF] Executed DbCommand (38ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", 0 AS "Place", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 13:49:31.625 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method243(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method243(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
2025-01-20 13:50:42.456 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 13:50:42.592 +04:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:50:42.601 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:50:42.622 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:50:42.641 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:50:42.642 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:50:42.649 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 13:50:42.683 +04:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 13:50:42.698 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 13:50:42.812 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 13:50:42.889 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 13:50:42.918 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 13:50:42.919 +04:00 [INF] Hosting environment: Development
2025-01-20 13:50:42.919 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 13:50:43.136 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 13:50:43.252 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 44.9623 ms
2025-01-20 13:50:43.257 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 123.8958ms
2025-01-20 13:50:43.257 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 13:50:43.261 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 13:50:43.265 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 3.5532ms
2025-01-20 13:50:43.283 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 25.613ms
2025-01-20 13:50:43.298 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 13:50:43.690 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 390.5613 ms
2025-01-20 13:50:43.692 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 393.5117ms
2025-01-20 13:51:04.156 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 13:51:04.170 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 13:51:04.403 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 13:51:04.427 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 13:51:04.439 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:51:04.448 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:51:04.473 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:51:04.537 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:51:06.516 +04:00 [INF] Executed DbCommand (10ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 13:51:07.038 +04:00 [INF] Executed DbCommand (17ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 13:51:11.074 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:51:11.075 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:51:11.161 +04:00 [INF] Executed DbCommand (82ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", 0 AS "Place", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 13:51:11.167 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 13:51:11.226 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 6775.3198ms
2025-01-20 13:51:11.228 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:51:11.284 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionLeaderboards/2 responded 500 in 7116.0510 ms
2025-01-20 13:51:11.288 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - 500 null application/json 7131.9671ms
2025-01-20 13:51:28.309 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 13:51:28.323 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:51:28.324 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:51:28.329 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:51:30.091 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:51:31.908 +04:00 [INF] Executed DbCommand (21ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 13:51:32.507 +04:00 [INF] Executed DbCommand (10ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 13:51:53.428 +04:00 [INF] Executed DbCommand (538ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l."Id", l."AnnouncementDate", l."CorrelationId", l."CreatedBy", l."CreationDate", l."Description", l."EndDate", l."EventType", l."IsGenerated", l."PromotionId", l."ScheduleId", l."StartDate", l."Status", l."TemplateId", l."Title"
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 13:52:37.046 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 13:52:37.183 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:52:37.192 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:52:37.213 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:52:37.232 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:52:37.233 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:52:37.239 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 13:52:37.275 +04:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 13:52:37.292 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 13:52:37.399 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 13:52:37.471 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 13:52:37.498 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 13:52:37.499 +04:00 [INF] Hosting environment: Development
2025-01-20 13:52:37.499 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 13:52:37.910 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 13:52:38.003 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 33.0122 ms
2025-01-20 13:52:38.006 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 98.5386ms
2025-01-20 13:52:38.006 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 13:52:38.009 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 13:52:38.011 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 5.309ms
2025-01-20 13:52:38.029 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 20.0349ms
2025-01-20 13:52:38.049 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 13:52:38.429 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 378.1979 ms
2025-01-20 13:52:38.431 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 381.6976ms
2025-01-20 13:52:49.865 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 13:52:49.870 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 13:52:50.119 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 13:52:50.144 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 13:52:50.156 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:52:50.166 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:52:50.192 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:52:50.258 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:52:52.030 +04:00 [INF] Executed DbCommand (12ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 13:52:52.114 +04:00 [INF] Executed DbCommand (12ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 13:52:57.474 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:52:57.476 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:52:57.496 +04:00 [INF] Executed DbCommand (11ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 13:52:57.499 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
2025-01-20 13:53:03.313 +04:00 [INF] Executed DbCommand (531ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l."Id", l."AnnouncementDate", l."CorrelationId", l."CreatedBy", l."CreationDate", l."Description", l."EndDate", l."EventType", l."IsGenerated", l."PromotionId", l."ScheduleId", l."StartDate", l."Status", l."TemplateId", l."Title"
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 13:53:12.548 +04:00 [INF] Executed DbCommand (523ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l."Id", l."AnnouncementDate", l."CorrelationId", l."CreatedBy", l."CreationDate", l."Description", l."EndDate", l."EventType", l."IsGenerated", l."PromotionId", l."ScheduleId", l."StartDate", l."Status", l."TemplateId", l."Title"
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 13:53:35.733 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 13:53:35.735 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
2025-01-20 13:54:24.003 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 13:54:24.247 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:54:24.255 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:54:24.276 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:54:24.294 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:54:24.296 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:54:24.302 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 13:54:24.338 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 13:54:24.353 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 13:54:24.476 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 13:54:24.550 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 13:54:24.579 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 13:54:24.580 +04:00 [INF] Hosting environment: Development
2025-01-20 13:54:24.581 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 13:54:25.087 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 13:54:25.220 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 35.6241 ms
2025-01-20 13:54:25.224 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 13:54:25.228 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 140.4992ms
2025-01-20 13:54:25.230 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 6.8503ms
2025-01-20 13:54:25.232 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 13:54:25.253 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 20.8224ms
2025-01-20 13:54:25.268 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 13:54:25.620 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 350.3995 ms
2025-01-20 13:54:25.621 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 353.5482ms
2025-01-20 13:54:39.761 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 13:54:39.766 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 13:54:39.992 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 13:54:40.014 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 13:54:40.026 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:54:40.035 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:54:40.059 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:54:40.141 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:54:42.081 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 13:54:42.280 +04:00 [INF] Executed DbCommand (21ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 13:54:43.622 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:54:43.623 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:54:43.642 +04:00 [INF] Executed DbCommand (13ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 13:54:43.646 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 13:54:43.704 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 3666.0363ms
2025-01-20 13:54:43.705 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:54:43.766 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionLeaderboards/2 responded 500 in 4001.9757 ms
2025-01-20 13:54:43.769 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - 500 null application/json 4008.3661ms
2025-01-20 13:56:29.658 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 13:56:29.810 +04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:56:29.820 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:56:29.843 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:56:29.864 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:56:29.866 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:56:29.872 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 13:56:29.911 +04:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 13:56:29.929 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 13:56:30.067 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 13:56:30.166 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 13:56:30.198 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 13:56:30.204 +04:00 [INF] Hosting environment: Development
2025-01-20 13:56:30.205 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 13:56:30.675 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 13:56:30.793 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 46.0434 ms
2025-01-20 13:56:30.796 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 13:56:30.797 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 13:56:30.798 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 126.0605ms
2025-01-20 13:56:30.800 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 3.9633ms
2025-01-20 13:56:30.822 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 24.9895ms
2025-01-20 13:56:30.841 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 13:56:31.221 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 378.0217 ms
2025-01-20 13:56:31.222 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 380.8677ms
2025-01-20 13:56:42.669 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 13:56:42.680 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 13:56:42.975 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 13:56:43.013 +04:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 13:56:43.027 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:56:43.036 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:56:43.070 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:56:43.158 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:56:45.522 +04:00 [INF] Executed DbCommand (46ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 13:56:45.973 +04:00 [INF] Executed DbCommand (17ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 13:56:47.724 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:56:47.725 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 13:56:47.796 +04:00 [INF] Executed DbCommand (66ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 13:56:47.800 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 13:56:47.859 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 4820.7185ms
2025-01-20 13:56:47.861 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:56:47.921 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionLeaderboards/2 responded 500 in 5242.2628 ms
2025-01-20 13:56:47.924 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - 500 null application/json 5255.1787ms
2025-01-20 13:57:10.967 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 13:57:12.787 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:57:12.788 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:57:12.792 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:57:12.796 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:57:13.356 +04:00 [INF] Executed DbCommand (9ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 13:57:13.363 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 13:57:13.392 +04:00 [INF] Executed DbCommand (27ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 13:57:13.394 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 13:57:13.426 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 636.8659ms
2025-01-20 13:57:13.427 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:57:13.452 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionLeaderboards/2 responded 500 in 2481.0477 ms
2025-01-20 13:57:13.454 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - 500 null application/json 2486.8336ms
2025-01-20 13:57:58.739 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/40 - null null
2025-01-20 13:57:58.743 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:57:58.746 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:57:58.750 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:57:58.757 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:58:00.193 +04:00 [INF] Executed DbCommand (5ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 13:58:00.201 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 13:58:00.209 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 13:58:00.211 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 13:58:00.244 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 1496.064ms
2025-01-20 13:58:00.246 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:58:00.272 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionLeaderboards/40 responded 500 in 1529.9243 ms
2025-01-20 13:58:00.273 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/40 - 500 null application/json 1533.8458ms
2025-01-20 13:58:25.729 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/12 - null null
2025-01-20 13:58:25.733 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:58:25.734 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 13:58:25.738 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 13:58:25.742 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 13:58:27.209 +04:00 [INF] Executed DbCommand (15ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 13:58:27.217 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 13:58:27.232 +04:00 [INF] Executed DbCommand (13ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 13:58:27.234 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 13:58:27.267 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 1531.3027ms
2025-01-20 13:58:27.268 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 13:58:27.293 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionLeaderboards/12 responded 500 in 1560.8023 ms
2025-01-20 13:58:27.293 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/12 - 500 null application/json 1564.6511ms
2025-01-20 13:59:39.667 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 13:59:39.821 +04:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:59:39.838 +04:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:59:39.865 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:59:39.994 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 13:59:39.996 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 13:59:40.003 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 13:59:40.041 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 13:59:40.058 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 13:59:40.237 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 13:59:40.332 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 13:59:40.380 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 13:59:40.380 +04:00 [INF] Hosting environment: Development
2025-01-20 13:59:40.381 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 13:59:40.798 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 13:59:40.927 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 48.6665 ms
2025-01-20 13:59:40.928 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 13:59:40.931 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 137.1948ms
2025-01-20 13:59:40.930 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 13:59:40.933 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 4.4077ms
2025-01-20 13:59:40.952 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 22.786ms
2025-01-20 13:59:40.970 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 13:59:41.363 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 391.8498 ms
2025-01-20 13:59:41.365 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 394.8602ms
2025-01-20 14:00:13.078 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 14:00:13.088 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 14:00:13.315 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 14:00:13.340 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 14:00:13.352 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:00:13.361 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 14:00:13.386 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 14:00:13.447 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 14:00:14.883 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 14:00:14.895 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:00:15.426 +04:00 [INF] Executed DbCommand (526ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l."Id", l."AnnouncementDate", l."CorrelationId", l."CreatedBy", l."CreationDate", l."Description", l."EndDate", l."EventType", l."IsGenerated", l."PromotionId", l."ScheduleId", l."StartDate", l."Status", l."TemplateId", l."Title"
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:00:15.432 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 14:00:15.461 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 2097.5686ms
2025-01-20 14:00:15.462 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:00:15.481 +04:00 [INF] HTTP GET /api/Promotion/GetPromotionLeaderboards/2 responded 200 in 2395.2702 ms
2025-01-20 14:00:15.483 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - 200 null application/json; charset=utf-8 2405.8564ms
2025-01-20 14:18:56.425 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 14:18:56.590 +04:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 14:18:56.600 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 14:18:56.628 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 14:18:56.653 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 14:18:56.654 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 14:18:56.661 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 14:18:56.710 +04:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 14:18:56.730 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 14:18:56.956 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 14:18:57.087 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 14:18:57.120 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 14:18:57.121 +04:00 [INF] Hosting environment: Development
2025-01-20 14:18:57.121 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 14:18:57.454 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 14:18:57.568 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 37.1636 ms
2025-01-20 14:18:57.570 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 14:18:57.571 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 14:18:57.574 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 122.2926ms
2025-01-20 14:18:57.575 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 4.6927ms
2025-01-20 14:18:57.595 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 23.8277ms
2025-01-20 14:18:57.615 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 14:18:58.096 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 479.8275 ms
2025-01-20 14:18:58.098 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 483.0429ms
2025-01-20 14:19:12.852 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 14:19:12.857 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 14:19:13.201 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 14:19:13.225 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 14:19:13.236 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:19:13.246 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 14:19:13.270 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 14:19:13.466 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 14:19:15.102 +04:00 [INF] Executed DbCommand (10ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 14:19:15.117 +04:00 [INF] Executed DbCommand (9ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:19:15.122 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 14:19:15.123 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 14:19:15.138 +04:00 [INF] Executed DbCommand (11ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 14:19:15.141 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 14:19:15.180 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 1932.0346ms
2025-01-20 14:19:15.182 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:19:15.239 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionLeaderboards/2 responded 500 in 2383.8599 ms
2025-01-20 14:19:15.243 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - 500 null application/json 2391.0945ms
2025-01-20 14:20:32.164 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/3 - null null
2025-01-20 14:20:32.173 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:20:32.174 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 14:20:32.179 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 14:20:32.183 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 14:20:33.347 +04:00 [INF] Executed DbCommand (14ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 14:20:33.356 +04:00 [INF] Executed DbCommand (7ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:20:33.366 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 14:20:33.371 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 14:20:33.378 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 1202.469ms
2025-01-20 14:20:33.379 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:20:33.382 +04:00 [INF] HTTP GET /api/Promotion/GetPromotionLeaderboards/3 responded 200 in 1213.9822 ms
2025-01-20 14:20:33.383 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/3 - 200 null application/json; charset=utf-8 1219.4144ms
2025-01-20 14:20:51.070 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 14:20:51.074 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:20:51.074 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 14:20:51.077 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 14:20:51.084 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 14:20:56.435 +04:00 [INF] Executed DbCommand (10ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 14:20:56.447 +04:00 [INF] Executed DbCommand (10ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:20:56.455 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 14:20:56.457 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 14:20:56.490 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 5414.1155ms
2025-01-20 14:20:56.492 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:20:56.519 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionLeaderboards/2 responded 500 in 5446.9919 ms
2025-01-20 14:20:56.520 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - 500 null application/json 5450.2332ms
2025-01-20 14:21:12.875 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 14:21:12.878 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:21:12.879 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 14:21:12.885 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 14:21:12.889 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 14:21:14.381 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 14:21:14.403 +04:00 [INF] Executed DbCommand (19ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:21:14.415 +04:00 [INF] Executed DbCommand (10ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 14:21:14.417 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 14:21:14.447 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 1564.6884ms
2025-01-20 14:21:14.448 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:21:14.473 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionLeaderboards/2 responded 500 in 1595.2877 ms
2025-01-20 14:21:14.474 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - 500 null application/json 1598.6259ms
2025-01-20 14:21:28.738 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/1 - null null
2025-01-20 14:21:28.741 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:21:28.741 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 14:21:28.746 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 14:21:28.749 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 14:21:30.492 +04:00 [INF] Executed DbCommand (10ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 14:21:32.883 +04:00 [INF] Executed DbCommand (10ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:21:32.952 +04:00 [INF] Executed DbCommand (67ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 14:21:32.953 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 14:21:32.955 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 4210.2245ms
2025-01-20 14:21:32.956 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:21:32.957 +04:00 [INF] HTTP GET /api/Promotion/GetPromotionLeaderboards/1 responded 200 in 4217.3835 ms
2025-01-20 14:21:32.958 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/1 - 200 null application/json; charset=utf-8 4220.3127ms
2025-01-20 14:21:49.638 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 14:21:49.641 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:21:49.642 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 14:21:49.645 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 14:21:49.651 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 14:21:53.897 +04:00 [INF] Executed DbCommand (508ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l."Id", l."AnnouncementDate", l."CorrelationId", l."CreatedBy", l."CreationDate", l."Description", l."EndDate", l."EventType", l."IsGenerated", l."PromotionId", l."ScheduleId", l."StartDate", l."Status", l."TemplateId", l."Title", l0."Id", l0."LeaderboardRecordId", l0."RepeatType", l0."RepeatValue", l0."Status", l0."Title"
FROM "LeaderboardRecords" AS l
LEFT JOIN "LeaderboardSchedules" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:22:00.101 +04:00 [INF] Executed DbCommand (24ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 14:22:15.508 +04:00 [INF] Executed DbCommand (518ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l."Id", l."AnnouncementDate", l."CorrelationId", l."CreatedBy", l."CreationDate", l."Description", l."EndDate", l."EventType", l."IsGenerated", l."PromotionId", l."ScheduleId", l."StartDate", l."Status", l."TemplateId", l."Title", l0."Id", l0."LeaderboardRecordId", l0."RepeatType", l0."RepeatValue", l0."Status", l0."Title"
FROM "LeaderboardRecords" AS l
LEFT JOIN "LeaderboardSchedules" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:22:17.440 +04:00 [INF] Executed DbCommand (104ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:22:28.439 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 14:22:28.440 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 14:22:28.471 +04:00 [INF] Executed DbCommand (28ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 14:22:28.476 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method213(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method213(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
2025-01-20 14:22:43.712 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 14:22:43.854 +04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 14:22:43.863 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 14:22:43.887 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 14:22:43.904 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 14:22:43.905 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 14:22:43.912 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 14:22:43.946 +04:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 14:22:43.960 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 14:22:44.067 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 14:22:44.142 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 14:22:44.170 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 14:22:44.171 +04:00 [INF] Hosting environment: Development
2025-01-20 14:22:44.172 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 14:22:44.524 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 14:22:44.649 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 33.8991 ms
2025-01-20 14:22:44.651 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 14:22:44.653 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 14:22:44.681 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 160.8889ms
2025-01-20 14:22:44.682 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 31.4895ms
2025-01-20 14:22:44.697 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 44.9062ms
2025-01-20 14:22:44.715 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 14:22:45.104 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 386.8935 ms
2025-01-20 14:22:45.105 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 389.9723ms
2025-01-20 14:23:00.178 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 14:23:00.183 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 14:23:00.416 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 14:23:00.439 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 14:23:00.451 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:23:00.459 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 14:23:00.482 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 14:23:00.544 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 14:23:02.574 +04:00 [INF] Executed DbCommand (43ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 14:23:02.590 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:23:02.596 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 14:23:02.598 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 14:23:02.613 +04:00 [INF] Executed DbCommand (11ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 14:23:02.617 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 14:23:02.655 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 2193.2942ms
2025-01-20 14:23:02.657 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:23:02.713 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionLeaderboards/2 responded 500 in 2531.2587 ms
2025-01-20 14:23:02.716 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - 500 null application/json 2538.8813ms
2025-01-20 14:23:23.389 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 14:23:23.401 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:23:23.402 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 14:23:23.407 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 14:23:23.412 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 14:23:24.437 +04:00 [INF] Executed DbCommand (10ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 14:23:24.450 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:23:24.463 +04:00 [INF] Executed DbCommand (9ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 14:23:24.465 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 14:23:24.496 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 1092.1851ms
2025-01-20 14:23:24.496 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:23:24.522 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionLeaderboards/2 responded 500 in 1128.1079 ms
2025-01-20 14:23:24.523 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - 500 null application/json 1134.3257ms
2025-01-20 14:23:35.203 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 14:23:35.206 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:23:35.208 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 14:23:35.212 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 14:23:35.219 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 14:23:37.685 +04:00 [INF] Executed DbCommand (53ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 14:23:37.723 +04:00 [INF] Executed DbCommand (35ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:23:37.733 +04:00 [INF] Executed DbCommand (8ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 14:23:37.734 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 14:23:37.766 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 2555.9993ms
2025-01-20 14:23:37.767 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:23:37.792 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionLeaderboards/2 responded 500 in 2587.1247 ms
2025-01-20 14:23:37.793 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - 500 null application/json 2590.3593ms
2025-01-20 14:23:57.347 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 14:23:57.349 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:23:57.350 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 14:23:57.355 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 14:23:57.360 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 14:23:58.744 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 14:23:58.761 +04:00 [INF] Executed DbCommand (15ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:23:58.772 +04:00 [INF] Executed DbCommand (9ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Title", l0."RepeatType", t."StartDate", t."EndDate"
FROM (
    SELECT l."Id", l."EndDate", l."StartDate", l."Title"
    FROM "LeaderboardRecords" AS l
    WHERE l."PromotionId" = @__promotionId_0
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN "LeaderboardSchedules" AS l0 ON t."Id" = l0."LeaderboardRecordId"
2025-01-20 14:23:58.776 +04:00 [ERR] An exception occurred while iterating over the results of a query for context type 'OnAim.Admin.Infrasturcture.Persistance.Data.LeaderBoard.LeaderBoardReadOnlyDataContext'.
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: Nullable object must have a value.
   at lambda_method204(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-01-20 14:23:58.806 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 1451.9226ms
2025-01-20 14:23:58.807 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:23:58.831 +04:00 [ERR] HTTP GET /api/Promotion/GetPromotionLeaderboards/2 responded 500 in 1482.0470 ms
2025-01-20 14:23:58.832 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - 500 null application/json 1485.2985ms
2025-01-20 14:26:19.914 +04:00 [INF] Starting database migration. Connection String: Host=192.168.88.138;Port=5432;Database=jan6;Username=postgres;Password=12345678;Pooling=true;
2025-01-20 14:26:20.179 +04:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 14:26:20.188 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 14:26:20.209 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 14:26:20.227 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-01-20 14:26:20.229 +04:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-01-20 14:26:20.235 +04:00 [INF] Applying migration '20250115095933_init'.
2025-01-20 14:26:20.274 +04:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AllowedDomains" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Domain" text NOT NULL,
    "CreatedBy" integer,
    "IsDeleted" boolean NOT NULL,
    "IsActive" boolean NOT NULL,
    "DateCreated" timestamp with time zone NOT NULL,
    "DateUpdated" timestamp with time zone NOT NULL,
    "DateDeleted" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_AllowedDomains" PRIMARY KEY ("Id")
);
2025-01-20 14:26:20.290 +04:00 [ERR] An error occurred while applying migrations.
Npgsql.PostgresException (0x80004005): 42P07: relation "AllowedDomains" already exists
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at OnAim.Admin.API.Extensions.MigrationExtensions.ApplyMigrations(IApplicationBuilder app) in C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API\Extensions\MigrationExtensions.cs:line 19
  Exception data:
    Severity: ERROR
    SqlState: 42P07
    MessageText: relation "AllowedDomains" already exists
    File: heap.c
    Line: 1151
    Routine: heap_create_with_catalog
2025-01-20 14:26:20.443 +04:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-20 14:26:20.544 +04:00 [INF] Now listening on: http://localhost:5192
2025-01-20 14:26:20.587 +04:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-20 14:26:20.588 +04:00 [INF] Hosting environment: Development
2025-01-20 14:26:20.589 +04:00 [INF] Content root path: C:\Users\user\Desktop\Work\OnAimHub\Admin\OnAim.Admin.API
2025-01-20 14:26:21.073 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/index.html - null null
2025-01-20 14:26:21.221 +04:00 [INF] HTTP GET /swagger/index.html responded 200 in 51.1556 ms
2025-01-20 14:26:21.226 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/index.html - 200 null text/html;charset=utf-8 155.5271ms
2025-01-20 14:26:21.232 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - null null
2025-01-20 14:26:21.234 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/_vs/browserLink - null null
2025-01-20 14:26:21.238 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 8.8488ms
2025-01-20 14:26:21.251 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/_vs/browserLink - 200 null text/javascript; charset=UTF-8 16.5432ms
2025-01-20 14:26:21.277 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - null null
2025-01-20 14:26:21.669 +04:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 389.8720 ms
2025-01-20 14:26:21.671 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 393.7661ms
2025-01-20 14:26:35.030 +04:00 [INF] Request starting HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - null null
2025-01-20 14:26:35.034 +04:00 [WRN] Failed to determine the https port for redirect.
2025-01-20 14:26:35.266 +04:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-01-20 14:26:35.291 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."Name", r."Description", r."IsActive", t0."EndpointGroupId", t0."Name", t0."Description", t0."RoleId", t0."Id", t0."Id0", t0."Name0", t0."Path", t0."Description0", t0."EndpointGroupId0", t0."Id00"
FROM "Roles" AS r
LEFT JOIN (
    SELECT r1."EndpointGroupId", e2."Name", e2."Description", r1."RoleId", e2."Id", t."Id" AS "Id0", t."Name" AS "Name0", t."Path", t."Description" AS "Description0", t."EndpointGroupId" AS "EndpointGroupId0", t."Id0" AS "Id00"
    FROM "RoleEndpointGroups" AS r1
    INNER JOIN "EndpointGroups" AS e2 ON r1."EndpointGroupId" = e2."Id"
    LEFT JOIN (
        SELECT e3."EndpointId" AS "Id", e4."Name", e4."Path", e4."Description", e3."EndpointGroupId", e4."Id" AS "Id0"
        FROM "EndpointGroupEndpoints" AS e3
        INNER JOIN "Endpoints" AS e4 ON e3."EndpointId" = e4."Id"
    ) AS t ON e2."Id" = t."EndpointGroupId"
) AS t0 ON r."Id" = t0."RoleId"
WHERE r."IsActive" AND NOT (r."IsDeleted") AND r."IsActive" AND EXISTS (
    SELECT 1
    FROM "RoleEndpointGroups" AS r0
    INNER JOIN "EndpointGroups" AS e ON r0."EndpointGroupId" = e."Id"
    WHERE r."Id" = r0."RoleId" AND EXISTS (
        SELECT 1
        FROM "EndpointGroupEndpoints" AS e0
        INNER JOIN "Endpoints" AS e1 ON e0."EndpointId" = e1."Id"
        WHERE e."Id" = e0."EndpointGroupId" AND NOT (e1."IsDeleted") AND e1."IsActive"))
ORDER BY r."Id", t0."RoleId", t0."EndpointGroupId", t0."Id", t0."EndpointGroupId0", t0."Id0"
2025-01-20 14:26:35.303 +04:00 [INF] Executing endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:26:35.312 +04:00 [INF] Route matched with {action = "GetPromotionLeaderboards", controller = "Promotion"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPromotionLeaderboards(Int32, OnAim.Admin.Contracts.Dtos.Base.BaseFilter) on controller OnAim.Admin.API.Controllers.PromotionController (OnAim.Admin.API).
2025-01-20 14:26:35.337 +04:00 [INF] Executed DbCommand (4ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."CreatedBy", r."DateCreated", r."DateDeleted", r."DateUpdated", r."Description", r."IsActive", r."IsDeleted", r."Name"
FROM "Roles" AS r
WHERE r."Name" = @__role_0 AND r."IsActive" AND NOT (r."IsDeleted")
LIMIT 1
2025-01-20 14:26:35.404 +04:00 [INF] Executed DbCommand (1ms) [Parameters=[@__endpoint_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."CreatedBy", e."DateCreated", e."DateDeleted", e."DateUpdated", e."Description", e."IsActive", e."IsDeleted", e."Name", e."Path", e."Type"
FROM "Endpoints" AS e
WHERE e."Name" = @__endpoint_0
LIMIT 1
2025-01-20 14:26:37.489 +04:00 [INF] Executed DbCommand (6ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l0."CoinId" AS "Prize", count(*)::int AS "Count"
FROM "LeaderboardRecords" AS l
INNER JOIN "LeaderboardRecordPrizes" AS l0 ON l."Id" = l0."LeaderboardRecordId"
WHERE l."PromotionId" = @__promotionId_0
GROUP BY l0."CoinId"
2025-01-20 14:26:37.504 +04:00 [INF] Executed DbCommand (9ms) [Parameters=[@__promotionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
2025-01-20 14:26:37.508 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 14:26:37.509 +04:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-01-20 14:26:37.545 +04:00 [INF] Executed DbCommand (35ms) [Parameters=[@__promotionId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT l."Id", l."Title", l."StartDate", l."EndDate"
FROM "LeaderboardRecords" AS l
WHERE l."PromotionId" = @__promotionId_0
LIMIT @__p_2 OFFSET @__p_1
2025-01-20 14:26:37.553 +04:00 [INF] Executing OkObjectResult, writing value of type 'OnAim.Admin.Contracts.ApplicationInfrastructure.ApplicationResult'.
2025-01-20 14:26:37.563 +04:00 [INF] Executed action OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API) in 2248.3199ms
2025-01-20 14:26:37.564 +04:00 [INF] Executed endpoint 'OnAim.Admin.API.Controllers.PromotionController.GetPromotionLeaderboards (OnAim.Admin.API)'
2025-01-20 14:26:37.582 +04:00 [INF] HTTP GET /api/Promotion/GetPromotionLeaderboards/2 responded 200 in 2549.5943 ms
2025-01-20 14:26:37.585 +04:00 [INF] Request finished HTTP/1.1 GET http://localhost:5192/api/Promotion/GetPromotionLeaderboards/2 - 200 null application/json; charset=utf-8 2555.4482ms
